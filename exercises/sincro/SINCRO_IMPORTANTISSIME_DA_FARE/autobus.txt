Problema:
Un autobus è dotato di N posti a sedere ed M posti in piedi. 
L'accesso dei passeggeri all'autobus avviene mediante tre entrate: 
una posizionata in testa, una in coda ed una al centro.
 Tutte le entrate possono essere utilizzate sia per salire che per 
scendere dall'autobus



def PORTA_IN_TESTA 1
def PORTA_CENTRALE 2
def PORTA_IN_CODA 3

var:
	mutex1,mutex2,mutex3 : semaforo binario (:=1)
	entrata,uscita : semaforo binario (:=1)
	num_persone_entranti,num_persone_uscenti : int (:=0)
	posti_liberi : int (:=n+m)
	

persone_uscenti()
int porta
porta=rand()%3
if (porta==1 || porta==3) then
	wait(mutex1)
	num_pers_uscenti++
	if (num_pers_uscenti == 1) then
		wait(entrata)
	end if
	signal(mutex1)
	esci dall'autobus
	wait(mutex3)
	posti_liberi ++
	signal(mutex3)
	wait(mutex1)
	num_pers_uscenti––
	if (num_pers_uscenti == 0) then
		signal(entrata)
	end if
	signal(mutex1)
else 
	wait(uscita);
	esci dall'autobus
	wait(mutex3)
	posti_liberi++
	signal(mutex3)
	signal(uscita)
end if


persone_entranti()
int porta
if (posti_liberi != 0 ) then
	porta=rand()%3
	if (porta==1 || porta==3) then
		wait(entrata)
		entra nell'autobus
		wait(mutex3)
		posti_liberi--
		signal(mutex3)	
		signal(entrata)
	else
		wait(mutex2)
		num_pers_entranti++
		if (num_pers_entranti == 1) then
			wait(uscita)
		end if
		signal(mutex2)
		entra nell'autobus
		wait(mutex3)
		posti_liberi--
		signal(mutex3)
		wait(mutex2)
		num_pers_entranti––
		if (num_pers_entranti == 0) then
			signal(uscita)
		end if
		signal(mutex2)
	end if
else
	rinuncia a salire
end if